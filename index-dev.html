<!doctype html>
<!--
Copyright (c) 2013, Empirical Modelling Group
All rights reserved.

See LICENSE.txt
-->

<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=0.9">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="theme-color" content="#132023" />
	<title>JS-EDEN</title>

	<link rel="stylesheet" type="text/css" href="css/jseden.css">
	<link rel="stylesheet" type="text/css" href="css/jquery-ui-1.9.2.custom.min.css">
	<link rel="stylesheet" type="text/css" href="css/eden.css">
	<link rel="stylesheet" type="text/css" href="css/menu-bar.css">
	<link rel="stylesheet" type="text/css" href="plugins/symbol-viewer/symbol-viewer.css">
	<link rel="stylesheet" type="text/css" href="css/contextmenu.css" />
	<link rel="stylesheet" type="text/css" href="css/highlighter.css" />
	<link rel="stylesheet" type="text/css" href="css/scriptbox.css" />
	<link rel="stylesheet" type="text/css" href="css/mobiletabs.css" />

	<script type="text/javascript" src="js/lib/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="js/lib/jquery-ui-1.9.2.custom.min.js"></script>
	<style type="text/css">
		/*If we ever upgrade to jquery.ui version 1.10 or later then remove the following rule. */
		.ui-front {
			z-index: 10000 !important;
		}

		div.jseden-dialog-plisting {
			box-sizing: border-box;
			padding-top: 40px;
			padding-bottom: 40px;
			padding-left: 80px;
			padding-right: 80px;
			/*border: 1px solid #eee;*/
			width: 100%;
			height: 100%;
			display: flex;
			flex-direction: row;
			flex-wrap: wrap;
			justify-content: center;
			overflow-y: auto;
		}

		div.cadence-plisting-entry {
			width: 200px;
			height: 142px;
			margin: 5px;
			background-repeat: no-repeat;
			cursor: pointer;
			color: #132023;
		}

		div.cadence-plisting-icon {
			border: 1px solid #eee;
			font-family: "FontAwesome";
			font-size: 60px;
			background: #f5f5f5;
			cursor: pointer;
			text-align: center;
			padding-top: 10px;
			padding-bottom: 10px;
		}

		div.cadence-plisting-title {
			font-weight: bold;
			font-family: Roboto,Arial,sans-serif;
			color: #424249;
			font-size: 14px;
			line-height: 16px;
			padding-left: 2px;
			margin-top: 8px;
		}

		div.cadence-plisting-subtitle {
			font-family: Roboto,Arial,sans-serif;
			color: #525259;
			font-size: 12px;
			line-height: 16px;
			padding-left: 2px;
		}

		div.cadence-plisting-entry:hover {
			color: #29454B;
		}

	</style>
</head>
<body>

<script src="js/lib/jquery.color.js"></script>
<script src="js/lib/jquery.hotkeys.js"></script>
<script src="js/lib/json2.js"></script>
<script src="js/lib/diff_match_patch.js"></script>
<script src="js/core/runtime.js"></script>
<script src="js/dummyconsole.js"></script>
<script src="js/arrayCompareFix.js"></script>
<script src="js/core/window-highlighter.js"></script>
<script src="js/core/maintainer.js"></script>
<script src="js/core/definition.js"></script>
<script src="js/core/polyglot.js"></script>
<script src="js/core/translator.js"></script>
<script src="js/core/eden.js"></script>
<script src="js/core/database.js"></script>
<script src="js/core/plugins.js"></script>
<script src="js/util/url.js"></script>
<script src="js/core/initialise.js"></script>
<script src="js/core/lex.js"></script>
<script src="js/core/errors.js"></script>
<script src="js/core/warnings.js"></script>
<script src="js/core/translator2.js"></script>
<script src="js/core/ast.js"></script>
<script src="js/core/statements.js"></script>
<script src="js/language/lang.js"></script>
<script src="js/wrappers.js"></script>
<script src="js/util/css.js"></script>
<script src="js/ui/highlighter.js"></script>
<script src="js/ui/contextmenu.js"></script>
<script src="js/ui/buttonbar.js"></script>
<script src="js/ui/mobiletabs.js"></script>
<script src="js/ui/scriptbox.js"></script>
<script src="js/ui/scriptview.js"></script>
<script src="js/ui/svgview.js"></script>
<script src="js/ui/menubar.js"></script>
<script src="plugins/symbol-viewer/symbol-viewer.js"></script>


<script type="text/javascript">
	Construit(undefined, function(loaded) {
		$(".loaddialog").remove();
		if (!loaded) {
			console.log("NOT LOADED");
			var lopts = $("#loadoptions");
			/*if (!Eden.restore()) {
				Eden.loadFromURL("library2/NewProject.js-e");
			}*/

			lopts.css("display","block");
			lopts.on("click","#restoreold",function() {
				Eden.restore();
				lopts.css("display","none");
			})
			.on("click","#loadnew",function() {
				Eden.loadFromURL("library2/NewProject.js-e");
				lopts.css("display","none");
			})
			.on("click",".project",function(e) {
				var path = e.currentTarget.getAttribute("data-path");
				var tag = parseInt(e.currentTarget.getAttribute("data-tag"));
				console.log("Load project: " + path + "@"+tag);
				Eden.load(path,tag,function() {
					lopts.css("display","none");
				});
			});

			var user = (Eden.DB.username) ? Eden.DB.username.split(" ").join("") : "nouser";
			var path = "jseden2/"+user;
			var plist = lopts.find(".jseden-dialog-plisting");
			Eden.DB.getDirectory(path, function(data) {
				console.log(data);
				for (var x in data) {
					//Eden.DB.getMeta(path+"/"+x,function(path,meta) {
						plist.append($('<div class="cadence-plisting-entry project" data-path="'+(path+"/"+x)+'" data-tag="'+Eden.DB.meta[path+"/"+x].latestID+'"><div class="cadence-plisting-icon">&#xf0c3;</div><div class="cadence-plisting-title">'+x+'</div></div>'));
						console.log(Eden.DB.meta[path+"/"+x]);
					//});
				}
			});
		}
	});
</script>

<div class="loaddialog">
<img src="images/construit_logo_2.png"/>
<div class="mainloader">Loading...</div>
<div class="loadmessage">Loading...</div>
</div>

<div id="loadoptions" class="modal" style="display: none;">
	<div class="modal-content">
		<div class="jseden-dialog-plisting">
			<div id="restoreold" class="cadence-plisting-entry"><div class="cadence-plisting-icon">&#xf01e;</div><div class="cadence-plisting-title">Restore</div></div>
			<div id="loadnew" class="cadence-plisting-entry"><div class="cadence-plisting-icon">&#xf067;</div><div class="cadence-plisting-title">New Project</div></div>
		</div>
	</div>
</div>

<div id="tooltip" style="display:none"></div>
</body>
</html>
